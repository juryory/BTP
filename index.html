<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>盲文转换</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        input {
            padding: 10px;
            width: 300px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #007BFF;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <h1>盲文字符转换为琴键</h1>

    <label for="brailleChar">输入盲文字符:</label><br>
    <input type="text" id="brailleChar" placeholder="如：⠓⠋⠦" onkeyup="convertToBinary()" /><br><br>

    <table id="resultTable">
        <thead>
            <tr>
                <th>盲字（每两个一行）</th>
                <th>二进制数字</th>
                <th>转换为十进制</th>
                <th>最近的钢琴音符</th>
            </tr>
        </thead>
        <tbody id="resultBody">
            <!-- 动态生成结果 -->
        </tbody>
    </table>

    <script>
        const brailleToBinary = {
            '⠃': '110000', '⠏': '111100', '⠍': '101100', '⠋': '110100',
            '⠙': '100110', '⠞': '011110', '⠝': '101110', '⠇': '111000',
            '⠛': '110110', '⠅': '101000', '⠓': '110010', '⠌': '001100',
            '⠟': '111110', '⠱': '100011', '⠚': '010110', '⠵': '101011',
            '⠉': '100100', '⠎': '011100', '⠔': '001010', '⠢': '010001',
            '⠊': '010100', '⠥': '101001', '⠬': '001101', '⠗': '111010',
            '⠪': '010101', '⠖': '011010', '⠮': '011101', '⠷': '111011',
            '⠫': '110101', '⠜': '001110', '⠑': '100010', '⠳': '110011',
            '⠿': '111111', '⠽': '101111', '⠺': '010111', '⠕': '101010',
            '⠾': '011111', '⠧': '111001', '⠦': '011001', '⠴': '001011',
            '⠼': '001111', '⠩': '100101', '⠭': '101101', '⠣': '110001',
            '⠡': '100001', '⠻': '110111', '⠶': '011011', '⠒': '010010',
            '⠲': '010011', '⠯': '111101', '⠸': '000111', '⠹': '100111'
        };

        const pianoFrequencies = [
            { note: "A0", freq: 27.5 }, { note: "A#0", freq: 29.14 }, { note: "B0", freq: 30.87 },
            { note: "C1", freq: 32.7 }, { note: "C#1", freq: 34.65 }, { note: "D1", freq: 36.71 },
            { note: "D#1", freq: 38.89 }, { note: "E1", freq: 41.2 }, { note: "F1", freq: 43.65 },
            { note: "F#1", freq: 46.25 }, { note: "G1", freq: 49.0 }, { note: "G#1", freq: 51.91 },
            { note: "A7", freq: 3520.0 }, { note: "A#7", freq: 3729.31 }, { note: "B7", freq: 3951.07 },
            { note: "C8", freq: 4186.01 }
        ];

        function findClosestNote(freq) {
            let closest = pianoFrequencies[0];
            let minDiff = Math.abs(freq - closest.freq);
            for (const pianoNote of pianoFrequencies) {
                const diff = Math.abs(freq - pianoNote.freq);
                if (diff < minDiff) {
                    closest = pianoNote;
                    minDiff = diff;
                }
            }
            return closest.note;
        }

        function convertToBinary() {
            const brailleChars = document.getElementById("brailleChar").value;
            let binaryString = "";
            const row = [];
            const resultBody = document.getElementById("resultBody");
            resultBody.innerHTML = "";
            
            for (let i = 0; i < brailleChars.length; i++) {
                const brailleChar = brailleChars[i];
                const binary = brailleToBinary[brailleChar];
                if (binary) {
                    binaryString += binary;
                    row.push(brailleChar);
                }
            }

            for (let i = 0; i < row.length; i += 2) {
                const braillePair = row.slice(i, i + 2).join('');
                const startBinaryIndex = i * 6;
                const binaryPair = binaryString.slice(startBinaryIndex, startBinaryIndex + 12);
                const decimalValue = parseInt(binaryPair, 2);
                const closestNote = findClosestNote(decimalValue);
                
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${braillePair}</td>
                    <td>${binaryPair}</td>
                    <td>${decimalValue}</td>
                    <td>${closestNote}</td>
                `;
                resultBody.appendChild(tr);
            }
        }
    </script>

</body>
</html>
